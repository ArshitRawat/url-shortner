<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>URL Shortener</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

  <div class="bg-white p-6 rounded-xl shadow-md max-w-md w-full">
    <h1 class="text-2xl font-semibold text-center mb-5">URL Shortener</h1>

    <!-- Input -->
    <input id="longURL" type="text" 
      placeholder="Enter your URL"
      class="w-full p-3 border border-gray-300 rounded mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400">

    <!-- Button -->
    <button onclick="shortenURL()" 
      class="w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600 transition">
      Shorten
    </button>

    <!-- Result -->
    <div id="result" class="mt-4 hidden">
      <p class="font-medium">Short URL:</p>
      <a id="shortURL" href="#" target="_blank" class="text-blue-600 underline"></a>
    </div>

    <!-- Analytics -->
    <div id="analytics" class="mt-3 hidden">
      <p class="font-medium">Clicks:</p>
      <span id="clicks" class="text-gray-700"></span>
    </div>

    <!-- Footer -->
    <p class="text-xs text-center text-gray-500 mt-6">
      Created by Arshit Rawat
    </p>
  </div>

  <script>
    async function shortenURL() {
      const longURL = document.getElementById("longURL").value;
      if (!longURL) return alert("Please enter a URL");

      const res = await fetch("http://34.121.41.174:5000/shorten", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ longURL })
      });

      const data = await res.json();
      if (data.short_url) {
        const shortLink = `http://34.121.41.174:5000/${data.short_url}`;
        
        document.getElementById("result").classList.remove("hidden");
        document.getElementById("shortURL").href = shortLink;
        document.getElementById("shortURL").textContent = shortLink;

        const analyticsRes = await fetch(`http://34.121.41.174:5000/analytics/${data.short_url}`);
        const stats = await analyticsRes.json();
        
        if (stats.clicks !== undefined) {
          document.getElementById("analytics").classList.remove("hidden");
          document.getElementById("clicks").textContent = stats.clicks;
        }
      } else {
        alert("Error: " + JSON.stringify(data));
      }
    }
  </script>

</body>
</html>
